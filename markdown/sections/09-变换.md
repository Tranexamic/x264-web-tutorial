## 变换

模拟信号转换为数字信号的主要步骤之一——将音量、亮度、温度、压力等信号/信息抽离为*单一结构的复杂组成*状态，如果这个单一结构是某种波形，那么就是不同振幅、频率和相位（即该波形的各种形态）的复杂组成：

- **振幅：**&#x6CE2;峰到波谷的高度距离，越大则声音越响，图像明暗处差距越大
- **频率：**&#x5355;位时间下的波周期次数（如演奏家按下琴键的次数每秒），越高则能表示的音高越高，图像越锐利
- **相位：**&#x6CE2;形在时间/空间的位置，决定了与其它波形的叠加和干涉程度

“DCT 像素”一般被称为系子（coefficients、即分量、或有相关值）。这些系子的强度可以为负数（波形反相）或者小数（微调波形，因计算机算整数更快且无需考虑舍入错误而少见）。变换块左上角的系数是直流（DC、Direct current）分量，代表整体亮度水平，其余的系数是交流（AC、Alternate current）分量，表示图像中的细节和纹理信息。

![DCT-Block](files/transform-quantization/DCT-Block.png)

注：变换处理使得信号得以被翻译解构，例如可以将音频转换为 MIDI 键位，再整理出纯钢琴的“Vocaloid”音乐：[Soundcloud](https://soundcloud.com/jc-gong-avoe/vocaloid_nanoscore-1171002022) / [AcFun](https://www.acfun.cn/v/ac31342770) / [哔哩哔哩](https://b23.tv/sPkURQv)。

### 量化

根据压缩强度给出一个除数或矩阵数组，将变换结果的每个值除以这个除数或矩阵中同位的值，只保留和使用商来解码播放，从而实现压缩。这步操作是压缩中画面损失最大的步骤。

#### 量化值（Quantization Parameter、QP）

由 CRF，ABR 等码率质量控制模式算出，以及率失真优化量化、模式决策等步骤所调整的中间变量

#### 量化步长 \\(Q\_{\text{step}}\\)

Quantization Step-size 是量化值量化强度参数值与实际量化强度之间的映射值。规则大致是量化强度增加 1，则 qStep 增加 0.125；QP 每 +6 则 qStep 乘以 2，使其越往后增量越大：

| QP                     | 0     | 1      | 2      | 3     | 4 | 5     | 6    | 7     | 8     | 9    | 10 | 12  | 14   | 16 | 18 | 20  | 22 | 24 | 26 | 28 | 30 | 32 | 34 | 36 | 38 | 40… |
| ---------------------- | ----- | ------ | ------ | ----- | - | ----- | ---- | ----- | ----- | ---- | -- | --- | ---- | -- | -- | --- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --- |
| \\(Q\_{\text{step}}\\) | 0.625 | 0.6875 | 0.8125 | 0.875 | 1 | 1.125 | 1.25 | 1.375 | 1.625 | 1.75 | 2  | 2.5 | 3.25 | 4  | 5  | 6.5 | 8  | 10 | 13 | 16 | 20 | 26 | 32 | 40 | 52 | 64… |

x264 中，量化值大致上存在于以下几处：

| 步骤          | 名称                                          | 应用              |
| ----------- | ------------------------------------------- | --------------- |
| 率控制         | CRF/ABR                                     | 逐帧量化强度（或全局量化强度） |
| I-P 帧质量比    | I-P Ratio                                   | P 帧量化强度         |
| P-B 帧质量比    | P-B Ratio                                   | B 帧量化强度         |
| 自适应量化       | Adaptive Quantzation AQ                     | 逐块量化强度          |
| （率失真优化）模式决策 | Mode Decision MD                            | 逐块量化强度          |
| 率失真优化量化     | Rate-distortion optimized quantization RDOQ | 逐块量化强度          |
| 色度块量化强度偏移   | --chroma-qp-offset                          | 亮度与色度块量化强度      |
